<html>

<header>
    <script type="text/javascript" src="/Users/neil/Documents/Programming/Javascript/d3.v2.min.js">
    </script>
</header>

<body>
    <div id="d3Div"></div>
</body>

<footer>

    <script type="text/javascript">



        function createNodeData(URLObject) {
            var nodeData = [];
            i = 0;
            for (URL in URLObject) {
                nodeData.push( { 'index':i, 'url': URL, 'x':100, 'y':300 } ) 
                i += 1
            }
            return nodeData
        };

        function createLinkData(URLObject) {
            var linkData = [];
            for (URL in URLObject) {
                for (j in URLObject[URL]) {
                    linkData.push( {
                                            'source': url_to_index[URL],
                                            'target': url_to_index[URLObject[URL][j]]
                                        } 
                                        )

                }
            }
            return linkData;
        };

        function createForceDirectedLayout(nodeData,linkData,charge_value,distance_value) {
            var force = d3.layout.force()
            .charge(charge_value)
            .distance(distance_value)
            .nodes(nodeData)
            .links(linkData)
            .size([960, 700])
            .start();

            var link = svg.selectAll("line.link")
            .data(linkData)
          .enter().append("svg:line")
            .style("stroke", "#ccc")
            .attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });

            var node = svg.selectAll("circle.node")
            .data(nodeData)
            .enter()
          .append("svg:circle")
            .style("fill", "#000")
            .style("stroke", "#fff")
            .attr("cx", function(d) { return d.x; })
            .attr("cy", function(d) { return d.y; })
            .attr("r", 5)
            .call(force.drag);



            force.on("tick", function() {
                link
                .attr("x1", function(d) { return d.source.x; })
                .attr("y1", function(d) { return d.source.y; })
                .attr("x2", function(d) { return d.target.x; })
                .attr("y2", function(d) { return d.target.y; });

                node
                .attr("cx", function(d) { return d.x; })
                .attr("cy", function(d) { return d.y; });
            });};

        function createURLToIndex(URLObject) {
            url_to_index = {};
            i = 0;
            for (URL in URLObject) {
                url_to_index[URL] = i;
                i += 1
            }
            return url_to_index;
        };


        var URLObject = {   'url1':['url2'] ,
                            'url2':['url3','url4'] ,
                            'url3':['url5'] ,
                            'url4':['url6'],
                            'url5' : [],
                            'url6': []
                        };

        var index_to_url = {};




        var url_to_index = createURLToIndex(URLObject)
        var nodeData = createNodeData(URLObject);
        var linkData = createLinkData(URLObject);
        

            
        // var test_linkData = [    {
        //                         'source': url_to_index['url1'], 
        //                         'target': url_to_index['url2']
        //                     }, 
        //                     {
        //                         'source': url_to_index['url2'],
        //                         'target': url_to_index['url3']
        //                     },
        //                     {
        //                         'source': url_to_index['url2'],
        //                         'target': url_to_index['url4']
        //                     } 
        //                 ];

        

        console.log(linkData);
        // console.log(test_linkData);

        // for (i in linkData) {
        //     console.log(linkData[i] == test_linkData[i])
        // }

                        // How does do ^^^^^ get rendered as objects??????

        // console.log(typeof url_to_index['url2']);

        // console.log( [    {
        //                         'source': url_to_index['url1'], 
        //                         'target': url_to_index['url2']
        //                     }, 
        //                     {
        //                         'source': url_to_index['url2'],
        //                         'target': url_to_index['url3']
        //                     },
        //                     {
        //                         'source': url_to_index['url2'],
        //                         'target': url_to_index['url4']
        //                     } 
        //                 ] );

        // console.log([{'source':1,'target':2}])



        // console.log(test_linkData);
        // console.log(linkData);

        
        // console.log(test_linkData == linkData);

        // for (URL in test_nodeData) {
        //     console.log(test_nodeData[URL]);
        // }

        // console.log('break');

        // for (link in test_linkData) {
        //     console.log(test_nodeData[link])
        // }




        var svg = d3.select("#d3Div").append("svg:svg")
          .attr("width", 960)
          .attr("height", 700);

        createForceDirectedLayout(nodeData,linkData,-120,30);

        

        // console.log(createURLToIndex(URLObject));

        

        



       
        

        
    </script>


</footer>



</html>